---
description: 仕様書の作成・編集時に自動適用される品質ルールと構成規約
globs:
  - "docs/spec_*.md"
---

# 仕様書作成スキル

仕様書（`docs/spec_*.md`）の作成・編集時に適用されるルール。

## 適用条件

- `docs/spec_*.md` ファイルを新規作成するとき
- 既存の仕様書を編集するとき
- ユーザーが仕様書の作成を依頼したとき

## 前提作業

- `docs/spec_list.md` で対象機能の番号・カテゴリ・機能名・概要を確認する
- 関連する仕様書が `docs/` にあれば読んで依存関係を把握する
- `docs/spec_x-x_specname_template.md` のフォーマットに従う
- ファイル名は `docs/spec_<機能番号>_<機能名英語>.md` とする（例: `docs/spec_1-1_map_display.md`）

## 品質ルール（必須遵守）

以下は `spec-quality-checker-rules.md` に基づく品質基準。すべて満たすこと。

| # | ルール | 検証方法 |
|---|--------|---------|
| 1 | 必須セクションがすべて含まれている | 後述の「必須セクション構成」と照合 |
| 2 | 概要に「誰が何のために使う機能か」が書かれている | 概要セクションに主語と目的が明記されているか |
| 3 | 画面を持つ機能ではモックアップ資料がリンクされている | セクション2にモックアップがあるか |
| 4 | 画面項目定義がモックアップと一致している | 3.1の項目がモックアップの要素を網羅しているか |
| 5 | 処理ロジックにエッジケースの動作が記載されている | 境界値・異常系・特殊条件が記述されているか |
| 6 | データ設計にデータの取得元が書かれている | 3.3にデータソースが明記されているか |
| 7 | テスト方針に「テスト項目の作り方」が書かれている | セクション6がテスト項目自体ではなく方針であるか |

## 必須セクション構成

```
# 仕様書: <機能番号> <機能名>

## 1. 概要
  - 誰が何のために使う機能か
  - この仕様の範囲と範囲外
  - 対応デバイス・使用技術

## 2. 画面レイアウト等の補足資料等の関連資料
  - モックアップ（テキストベースまたは画像リンク）
  - 参照ドキュメントへのリンク
  - アセット情報

## 3. 機能詳細
  ### 3.1 画面要素
    - 画面項目定義（モックアップと一致させる）
    - 各要素のサイズ・色・配置
  ### 3.2 処理ロジック
    - 主要処理フロー
    - エッジケース（境界値・異常系・特殊条件）
  ### 3.3 データ設計
    - データ取得元
    - データ構造（型・フォーマット・制約）
    - API設計（エンドポイント・リクエスト/レスポンス）

## 4. 非機能要件
  - パフォーマンス要件
  - その他制約

## 5. 考慮事項・制限事項
  - 範囲外事項
  - 将来対応予定

## 6. テスト方針
  - テスト項目の作り方（項目そのものではない）
  - テスト観点（正常系・異常系・境界値・性能）
  - テスト手法（Playwright UIテスト・ユニットテスト等）
  - テストデータの準備方針

## 7. テスト項目
  ### <カテゴリ>
  - <テスト項目>
```

## ヒアリング項目

仕様書作成に必要な情報が不足している場合、以下をユーザーに確認する。

- 機能の目的と利用者
- 画面の有無（画面がある場合はモックアップの有無）
- データの取得元・保存先
- パフォーマンス要件の有無
- 他機能との依存関係

## 完成時の自己検証

仕様書を書き終えたら以下をすべて検証し、不合格があれば修正する。

- [ ] 必須セクション（概要・画面設計・処理ロジック・データ設計・非機能要件・テスト方針・テスト項目）がすべて含まれている
- [ ] 概要に「誰が何のために使う機能か」が書かれている
- [ ] 画面がある機能でモックアップ資料がリンクされている
- [ ] 画面項目定義がモックアップと一致している
- [ ] 処理ロジックにエッジケースの動作が記載されている
- [ ] データ設計にデータの取得元が書かれている
- [ ] テスト方針に「テスト項目の作り方」が書かれている
- [ ] `spec_list.md` と機能番号・機能名が整合している
