# 仕様書: 1-1 マップ表示

## 1. 概要

プレイヤーがゲームの戦略フェーズにおいて、マップ全体の状況を視覚的に把握するための機能。18種の地形タイルで構成されたマップを描画し、スクロール・ズーム・タイル選択などの操作でマップ上の情報を確認できるようにする。

**この仕様の範囲**: マップの描画、スクロール、ズーム、タイル選択、地形情報表示、ミニマップ、ステータスバーの表示

**範囲外**: ユニットの描画・移動（2-1）、占領処理（1-2）、戦闘遷移（3-1）、ユニット生産UI（5-1）、ターン進行ロジック（7-1）

**対応デバイス**: PC（マウス・キーボード）、モバイル（タッチ操作）

**使用技術**: HTML5 Canvas、JavaScript（バニラ）、Google Fonts（DotGothic16）

**設定ファイル**: 画面の定数値（色・フォントサイズ・レイアウト・マップパラメータ等）はすべて `src/config/` 配下のJSONファイルに外出しされている。本仕様書では具体値を記載せず、JSONキー名で参照する。

| JSONファイル | 内容 |
|---|---|
| `src/config/ui_theme.json` | UI色・フォントサイズ・レイアウト定数 |
| `src/config/map_settings.json` | タイルサイズ・ズーム・スクロール等のマップ表示パラメータ |
| `src/config/terrains.json` | 地形定義（18種）・移動コスト |
| `src/config/map_sample.json` | サンプルマップデータ・ユニット配置 |

## 2. 画面レイアウト等の補足資料等の関連資料

### 2.1 モックアップ

- [マップ表示モックアップHTML](mockups/spec_1-1_map_display.html)
- [参考画像（原作スクリーンショット）](mockups/spec_1-1_map_display_sample.jpg)

### 2.2 参照ドキュメント

- [機能一覧](spec_list.md)

### 2.3 アセット

- **地形タイル画像**: `assets/terrain/` 配下の18種GIFファイル（各タイルの基本サイズは `map_settings.json > tile.size` を参照）
- **マップデータ**: `assets/maps/map01.png` 〜 `map30.png`（将来的にデータ化予定）
- **フォント**: `ui_theme.json > fonts.family` を参照（Google Fonts CDN）

## 3. 機能詳細

### 3.1 画面要素

画面は大きく **マップエリア**（上部）と **ステータスバー**（下部固定）の2領域で構成される。全体の最大幅は `ui_theme.json > layout.maxWidth` を参照し、画面中央に配置する。

#### 3.1.1 マップエリア

| 要素 | 説明 |
|------|------|
| メインキャンバス | マップを描画するHTML5 Canvas。`image-rendering: pixelated` でドット絵のシャープさを保持 |
| 地形タイル | `map_settings.json > tile.size` の基本サイズの地形画像をスケール倍率に応じて拡大描画。画像読み込み失敗時はフォールバックカラーで塗りつぶし |
| ホバーハイライト | マウスカーソル直下のタイルを強調。塗り・枠・線幅は `ui_theme.json > colors.highlight.hover` を参照 |
| 選択ハイライト | 選択中タイルを枠で強調、`map_settings.json > animation.blinkInterval` 間隔で点滅。色・線幅・コーナー比率は `ui_theme.json > colors.highlight.selection` を参照 |
| 地形情報オーバーレイ | マップエリア左下に半透明背景で座標と地形名を表示。書式: `(col, row) | 地形名`。色・配置は `ui_theme.json > colors.overlay`・`layout.overlay` を参照 |

#### 3.1.2 ステータスバー

最大高さ・背景色は `ui_theme.json > layout.statusBar.maxHeight`・`colors.statusBar.background` を参照。3カラム構成。画面が小さい場合は自動的に縮小される（レスポンシブ対応参照）。

| 位置 | 要素 | 詳細 |
|------|------|------|
| 左カラム | P1プレイヤー情報 | IG（収入）、CT（資金）、GP数、T（生産中）数、GB数、ユニット総数 |
| 中央カラム | ターン・ミニマップ | ターン番号（色は `colors.turn.number`、背景は `colors.turn.numberBg`）、フェーズ表示（色は `colors.turn.phase`）、ミニマップキャンバス |
| 右カラム | P2プレイヤー情報 | 左カラムと同じ項目を右寄せで表示 |

**色定義**: すべて `ui_theme.json > colors` 配下で定義。

| 要素 | JSONキー |
|------|-----|
| IG/CT値 | `colors.resource` |
| GPアイコン | `colors.statIcons.gp` |
| GBアイコン | `colors.statIcons.gb` |
| T（生産中）アイコン | `colors.statIcons.t` |
| P1ユニット数 | `colors.player1.unitCount` |
| P2ユニット数 | `colors.player2.unitCount` |
| ターン番号 | `colors.turn.number` |
| フェーズ | `colors.turn.phase` |

**フォント**: `ui_theme.json > fonts.family` を参照。各要素のフォントサイズは `fonts.*` で定義。

**レスポンシブ対応（小画面）**:

スマートフォン等の小さい画面でもステータスバーが画面外にはみ出さないよう、以下の方針でレスポンシブ対応する。

**ビューポート高さの基準**:
- `100dvh`（Dynamic Viewport Height）を使用し、スマホブラウザのアドレスバー等の動的なUI要素に追従する
- `dvh` 非対応ブラウザ向けに `100vh` をフォールバックとして併記する

**レイアウト方針**:
- ゲームコンテナ（`.game-container`）は `height: 100dvh` で実際の表示領域に合わせる
- マップエリアは `flex: 1; min-height: 0` で残り領域を使い切る
- ステータスバーは `height: auto; max-height:` `ui_theme.json > layout.statusBar.maxHeight` とし、内容量に応じた高さで最大値までとする
- ステータスバー内の各要素のフォントサイズは `clamp()` を使い、ビューポート高さに応じて自動的にスケーリングする

**フォントサイズのスケーリング**: `ui_theme.json > fonts` でclamp値を定義。

| 要素 | JSONキー |
|------|--------|
| ユニット数 | `fonts.unitCount` |
| ターン番号 | `fonts.turnNumber` |
| フェーズ | `fonts.turnPhase` |
| IG/CT | `fonts.resource` |
| その他（GP/GB/T） | `fonts.stat` |

**制約**:
- ステータスバーの全要素が、あらゆるビューポートサイズで画面内に収まること（はみ出し不可）
- P1/P2の各プレイヤー情報は `overflow: hidden` でテキストがカラムからはみ出さないようにする
- IG/CTなどの `white-space: nowrap` テキストはカラム幅を超えた場合に末尾を省略（`text-overflow: ellipsis`）する
- PC表示（高さ800px以上）ではステータスバーの高さが概ね従来相当となること

#### 3.1.3 ミニマップ

| 項目 | 参照 |
|------|-----|
| サイズ | `map_settings.json > miniMap.width` × `miniMap.height` |
| 枠線 | `ui_theme.json > colors.miniMap.border` |
| 背景 | `ui_theme.json > colors.miniMap.background` |
| 描画方式 | 各タイルをフォールバックカラーで塗りつぶし（画像は使用しない） |
| ビューポート表示 | メインマップの表示範囲を `ui_theme.json > colors.miniMap.viewport` の色・線幅で表示 |

### 3.2 処理ロジック

#### 3.2.1 マップ描画処理

1. Canvas全体をクリア
2. 現在のスクロール位置とスケールから、画面内に表示されるタイル範囲を計算（視野外タイルは描画スキップ）
3. 範囲内の各タイルについて:
   - 画像が読み込み済みの場合: `drawImage` でスケール倍率に応じて描画
   - 画像未読み込み/読み込み失敗の場合: フォールバックカラーで `fillRect`
4. ホバーハイライトを描画（カーソル位置のタイルのみ）
5. 選択ハイライトを描画（選択中かつ点滅状態が表示の場合のみ）

#### 3.2.2 スクロール処理

| 操作 | 動作 |
|------|------|
| マウスドラッグ | ドラッグ量に応じてピクセル単位でスクロール。Canvas座標系に変換して計算 |
| タッチドラッグ | 1本指タッチでマウスドラッグと同様の動作 |
| キーボード矢印キー | 1回押下につき `map_settings.json > scroll.keyboardSpeed` pxスクロール。`e.preventDefault()` でページスクロールを抑制 |
| ミニマップクリック/ドラッグ | クリック位置を中心にメインマップのビューを移動。クリックしたままマウスを動かすとメインマップが追従してスクロールする |

**スクロール制約（エッジケース）**:
- スクロール位置は `0` 〜 `(マップ全体サイズ - Canvas表示サイズ)` にクランプ
- マップ全体がCanvas内に収まる場合、スクロールは無効（最大値が0になる）
- ウィンドウリサイズ時にもクランプを再適用

**マップ中央配置**:
- マップ全体の描画サイズがCanvas表示サイズより小さい場合、マップをCanvas中央に配置する
- オフセット計算: `offsetX = max(0, (canvasW - MAP_COLS * tileScaledSize) / 2)`、Y軸も同様
- このオフセットはタイル描画、グリッド線、ホバー/選択ハイライト、ユニット描画、座標変換のすべてに適用する
- `window.gameState` に `mapOffsetX`, `mapOffsetY` を公開する

#### 3.2.3 ズーム処理

| 操作 | 動作 |
|------|------|
| マウスホイール | ホイール上で拡大（`map_settings.json > zoom.wheelFactor.zoomIn`）、下で縮小（`zoom.wheelFactor.zoomOut`）。カーソル位置を中心にズーム |
| ピンチ（タッチ） | 2本指の距離変化に比例してスケール変更。ピンチ中心を基準にズーム |

**ズーム制約**:
- スケール範囲: `map_settings.json > zoom.min` 〜 `zoom.max`
- ズーム時、カーソル/ピンチ中心のマップ座標を維持するようスクロール位置を再計算
- ズーム後にスクロールクランプを適用

#### 3.2.4 タイル選択処理

| 操作 | 動作 |
|------|------|
| クリック（マウス） | ドラッグ距離が `map_settings.json > scroll.dragThreshold.mouse` px以下の場合のみ選択として扱う |
| タップ（タッチ） | ドラッグ距離が `map_settings.json > scroll.dragThreshold.touch` px以下の場合のみ選択として扱う |

**選択ロジック**:
- 同じタイルを再度選択すると選択解除（トグル動作）
- マップ範囲外のタイル座標は選択不可
- 選択時は点滅状態を表示状態にリセット

**点滅処理**:
- `map_settings.json > animation.blinkInterval` ごとに表示/非表示を切り替え（`setInterval`）
- 選択タイルがない場合は点滅タイマーの描画更新をスキップ

#### 3.2.5 座標変換処理

Canvas上のクライアント座標（clientX/clientY）をマップ座標（col/row）に変換する。

```
canvasX = (clientX - canvasRect.left) × (canvasWidth / canvasRect.width)
canvasY = (clientY - canvasRect.top) × (canvasHeight / canvasRect.height)
col = floor((canvasX + scrollX) / tileScaledSize)
row = floor((canvasY + scrollY) / tileScaledSize)
```

- `tileScaledSize = TILE_SIZE × scale`（`map_settings.json > tile.size` × スケール倍率）
- CSSによるCanvas引き伸ばしに対応するため、クライアント座標をCanvas内部座標に変換してから計算

#### 3.2.6 ホバー処理

- マウス移動時（ドラッグ中でない場合）にカーソル位置のマップ座標を計算
- 座標がマップ範囲内の場合: ホバー状態を更新し、地形情報オーバーレイを表示
- マウスがCanvasから離脱した場合: ホバー状態をリセット、オーバーレイを非表示

#### 3.2.7 ミニマップ処理

**描画**:
1. マップ全体を `map_settings.json > miniMap` のサイズに縮小し、各タイルをフォールバックカラーで塗りつぶし
2. メインマップの現在のビューポート範囲を `ui_theme.json > colors.miniMap.viewport` の色で表示
3. ビューポート枠がミニマップ領域を超えないようクリップ

**操作（マウス）**:
- クリック: クリック位置に対応するマップ座標を中心にメインマップのビューを移動
- ドラッグ: mousedown でドラッグ状態に入り、mousemove でマウス位置に追従してメインマップをスクロールし続ける。mouseup でドラッグ状態を解除

**操作（タッチ）**:
- タップ: タップ位置に対応するマップ座標を中心にメインマップのビューを移動
- タッチドラッグ: touchstart でドラッグ状態に入り、touchmove でタッチ位置に追従してメインマップをスクロールし続ける。touchend でドラッグ状態を解除
- ミニマップ上で `touch-action: none` を設定し、ブラウザデフォルトのタッチジェスチャー（スクロール等）を抑制する

**座標変換式（マウス・タッチ共通）**:
- `scrollX = (pointerX / miniMapWidth) × MAP_COLS × tileScaledSize - canvasW / 2`
- `scrollY = (pointerY / miniMapHeight) × MAP_ROWS × tileScaledSize - canvasH / 2`
- 変換後にスクロールクランプを適用

#### 3.2.8 画像読み込み処理

- 全18種の地形タイル画像を `map_settings.json > tile.assetBasePath` から非同期読み込み
- `onload`/`onerror` の両方をカウントし、全画像の読み込み完了後にCanvas初期描画を実行
- 読み込み失敗した画像は `null` をセットし、描画時にフォールバックカラーを使用

#### 3.2.9 リサイズ処理

- `window.resize` イベントでCanvasサイズをマップエリアのクライアントサイズに再設定
- リサイズ後にスクロールクランプ→メインマップ描画→ミニマップ描画を実行

#### 3.2.10 設定ファイル読み込み処理

- ページ読み込み時に `src/config/` 配下の4つのJSONファイルを `fetch` で非同期読み込みする
- 読み込み完了後にCSS カスタムプロパティ（`var(--xxx, フォールバック値)`）を適用し、Canvas描画パラメータを設定する
- 読み込み失敗時はCSSフォールバック値とJavaScript内のデフォルト値で表示を維持する

### 3.3 データ設計

#### 3.3.1 地形データ

**データ取得元**: `src/config/terrains.json > terrains` 配列（将来的にはGASからの読み込みに変更予定）

```javascript
// 地形定義 (18種) — terrains.json > terrains 配列
const TERRAINS = [
  { id: number, name: string, file: string, color: string }
  // ...
];
```

| フィールド | 型 | 説明 |
|------------|-----|------|
| id | number | 地形ID（1〜18） |
| name | string | 日本語地形名 |
| file | string | タイル画像ファイル名（GIF） |
| color | string | フォールバックカラー（HEX） |

**地形一覧**: `src/config/terrains.json > terrains` 配列を参照（18種の地形定義）

#### 3.3.2 マップデータ

**データ取得元**: `src/config/map_sample.json > map`（将来的にはGASからの読み込みに変更予定）

```javascript
// マップデータ (rows × cols の2次元配列) — map_sample.json > map
const MAP_DATA = number[][];
```

| フィールド | 型 | 制約 |
|------------|-----|------|
| MAP_DATA[row][col] | number | 地形ID（1〜18）。TERRAINS配列のidと一致すること |
| MAP_ROWS | number | マップの行数（`map_sample.json > map` の配列長から算出） |
| MAP_COLS | number | マップの列数（`map_sample.json > map[0]` の配列長から算出） |

#### 3.3.3 表示状態

| 変数 | 型 | 初期値 | 説明 |
|------|-----|--------|------|
| scale | number | `map_settings.json > zoom.initial` | 現在のズーム倍率 |
| scrollX | number | 0 | 水平スクロール位置（px） |
| scrollY | number | 0 | 垂直スクロール位置（px） |
| hoverCol | number | -1 | ホバー中のタイル列（-1で無効） |
| hoverRow | number | -1 | ホバー中のタイル行（-1で無効） |
| selectedCol | number | -1 | 選択中のタイル列（-1で未選択） |
| selectedRow | number | -1 | 選択中のタイル行（-1で未選択） |
| blinkVisible | boolean | true | 選択カーソルの点滅表示状態 |

#### 3.3.4 定数

マップ表示に関する定数は `src/config/map_settings.json` に外出し。

| 定数 | JSONキー | 説明 |
|------|-----|------|
| TILE_SIZE | `tile.size` | タイル基本サイズ（px） |
| MIN_SCALE | `zoom.min` | 最小ズーム倍率 |
| MAX_SCALE | `zoom.max` | 最大ズーム倍率 |
| SCROLL_SPEED | `scroll.keyboardSpeed` | キーボードスクロール速度（px/回） |

### 3.4 テスト用インターフェース

#### 3.4.1 実装ファイルパス

- `src/index.html` — マップ表示のメインページ

#### 3.4.2 data-testid 属性

テストコードからDOM要素を特定するため、以下の `data-testid` 属性を実装時に付与すること。

| data-testid | 対象要素 |
|---|---|
| `game-container` | ゲーム全体のコンテナ |
| `map-area` | マップエリア |
| `map-canvas` | メインマップCanvas |
| `terrain-overlay` | 地形情報オーバーレイ |
| `coord-text` | 座標テキスト |
| `terrain-name` | 地形名テキスト |
| `status-bar` | ステータスバー |
| `p1-info` | P1プレイヤー情報エリア |
| `p2-info` | P2プレイヤー情報エリア |
| `p1-ig` | P1 IG値 |
| `p1-ct` | P1 CT値 |
| `p1-gp` | P1 GP数 |
| `p1-gb` | P1 GB数 |
| `p1-production` | P1 生産中数 |
| `p1-unit-count` | P1 ユニット総数 |
| `p2-ig` | P2 IG値 |
| `p2-ct` | P2 CT値 |
| `p2-gp` | P2 GP数 |
| `p2-gb` | P2 GB数 |
| `p2-production` | P2 生産中数 |
| `p2-unit-count` | P2 ユニット総数 |
| `turn-number` | ターン番号 |
| `turn-phase` | フェーズ表示 |
| `mini-map-canvas` | ミニマップCanvas |

#### 3.4.3 グローバル状態オブジェクト（window.gameState）

テストコードから内部状態を読み取るため、`window.gameState` を公開すること。

```javascript
window.gameState = {
  scale: number,       // 現在のズーム倍率
  scrollX: number,     // 水平スクロール位置（px）
  scrollY: number,     // 垂直スクロール位置（px）
  selectedCol: number, // 選択中タイル列（-1で未選択）
  selectedRow: number, // 選択中タイル行（-1で未選択）
  hoverCol: number,    // ホバー中タイル列（-1で無効）
  hoverRow: number,    // ホバー中タイル行（-1で無効）
  MAP_COLS: number,    // マップ列数
  MAP_ROWS: number,    // マップ行数
  TILE_SIZE: number,   // タイル基本サイズ
  MIN_SCALE: number,   // 最小ズーム倍率
  MAX_SCALE: number,   // 最大ズーム倍率
  SCROLL_SPEED: number // キーボードスクロール速度
};
```

- `gameState` は描画更新のたびに最新の値を反映すること
- 読み取り専用として公開し、テストコードからの書き込みは想定しない

## 4. 非機能要件

- **描画性能**: 60fpsを目標とする。視野外タイルの描画スキップにより、大きなマップでも安定した描画速度を維持すること
- **`image-rendering: pixelated`** を適用し、ドット絵の拡大時にぼやけない描画を実現すること
- **レスポンシブ**: ウィンドウリサイズに追従してCanvasサイズを動的に変更すること
- **タッチ操作**: `touch-action: none` でブラウザデフォルトのタッチジェスチャーを無効化し、ゲーム操作と競合しないこと
- **初期表示**: 設定JSONファイルと全タイル画像の読み込み完了後に初期描画を行い、画像ロード中の表示崩れを防ぐこと
- **設定読み込み失敗時**: CSSフォールバック値とJSデフォルト値で表示を維持すること

## 5. 考慮事項・制限事項

- **ユニット描画は範囲外**: ユニットのマップ上での描画・選択・移動は仕様 2-1（ユニット移動）で対応する。本仕様はマップ地形の描画のみを扱う
- **占領状態の表示は範囲外**: GP/GBのプレイヤー別カラー切り替えは仕様 1-2（占領システム）で対応する。本仕様ではGP/GBは固定の1色で表示する
- **ステータスバーの値は静的**: 本仕様ではステータスバーの値（IG、CT、GP数など）はハードコードされたダミー値を表示する。動的な更新はターン管理（7-1）やユニット生産（5-1）と連携して行う
- **マップデータは設定JSON**: `src/config/map_sample.json` にサンプルマップを定義する。GASからの動的読み込みは将来対応
- **GP/GBの軍別アイコン**: `assets/terrain/` にはGP/GBそれぞれ赤版・青版の画像があるが、本仕様では各1色のみ使用する。占領状態に応じたアイコン切り替えは 1-2 で対応
- **サウンド**: 本仕様では効果音・BGMは扱わない

## 6. テスト方針

### テスト観点

- **正常系**: 各操作（スクロール、ズーム、タイル選択、ミニマップ）が仕様通りに動作すること
- **境界値**: スクロール範囲の端、ズームの最大/最小、マップ端のタイル選択
- **異常系**: 画像読み込み失敗時のフォールバック表示、マップ範囲外クリック
- **性能**: 描画が滑らかに動作すること（目視確認）
- **クロスデバイス**: PC（マウス・キーボード）とモバイル（タッチ操作）の両方で動作確認

### テスト手法

- **Playwright UIテスト**: ページ表示、要素の存在確認、マウス操作シミュレーション、スクリーンショット比較
- **目視確認**: アニメーション（点滅）、描画品質、レスポンシブ表示はPlaywrightテスト後に人間が目視で最終確認

### テストデータ

- `src/config/map_sample.json` のサンプルマップデータを使用
- 18種すべての地形タイルがサンプルマップ内に含まれていること

## 7. テスト項目

### 初期表示

- ページを開くとマップエリアとステータスバーが表示される
- 18種すべての地形タイルが正しい色または画像で描画される
- グリッド線は表示されない
- ステータスバーにP1情報（IG, CT, GP, T, GB, ユニット数）が表示される
- ステータスバーにP2情報（IG, CT, GP, T, GB, ユニット数）が表示される
- ステータスバー中央にターン番号とフェーズが表示される
- ミニマップが表示され、マップ全体の縮小図が描画される
- ミニマップ上にビューポート範囲を示す枠が表示される

### スクロール（マウスドラッグ）

- マップ上でマウスをドラッグするとマップがスクロールする
- ドラッグ方向と逆方向にマップが移動する（自然なスクロール）
- ドラッグ中はカーソルが `grabbing` になる
- スクロール中にミニマップのビューポート枠が連動して移動する

### スクロール（キーボード）

- 矢印キー左でマップが左にスクロールする
- 矢印キー右でマップが右にスクロールする
- 矢印キー上でマップが上にスクロールする
- 矢印キー下でマップが下にスクロールする
- 1回の押下で `map_settings.json > scroll.keyboardSpeed` pxスクロールする

### スクロール境界

- マップ左端を超えてスクロールできない（scrollX が 0 未満にならない）
- マップ上端を超えてスクロールできない（scrollY が 0 未満にならない）
- マップ右端を超えてスクロールできない
- マップ下端を超えてスクロールできない

### マップ中央配置

- マップ全体がCanvas幅より小さい場合、マップが水平方向に中央配置される（mapOffsetX > 0）
- マップ全体がCanvas高さより小さい場合、マップが垂直方向に中央配置される（mapOffsetY > 0）
- マップがCanvasより大きい場合、オフセットは0で従来通り左上起点で描画される

### ズーム（マウスホイール）

- ホイール上回転でマップが拡大される
- ホイール下回転でマップが縮小される
- ズーム時、カーソル位置のマップ座標が維持される（カーソル下の地形が変わらない）
- ズーム後にミニマップのビューポート枠が更新される

### ズーム境界

- ズーム倍率が最小値未満にならない
- ズーム倍率が最大値を超えない
- 最小ズームでさらに縮小操作しても表示が崩れない
- 最大ズームでさらに拡大操作しても表示が崩れない

### タッチ操作

- 1本指ドラッグでマップがスクロールする
- 2本指ピンチインでマップが縮小される
- 2本指ピンチアウトでマップが拡大される
- ピンチ操作のズーム中心が2本指の中間点になる
- ピンチからドラッグへの切り替え（指を1本離す）が正常に動作する

### タイル選択

- マップ上のタイルをクリックすると選択枠が表示される
- 選択枠が `map_settings.json > animation.blinkInterval` 間隔で点滅する
- 選択中のタイルを再度クリックすると選択が解除される
- 別のタイルをクリックすると選択が移動する
- ドラッグ操作ではタイルが選択されない（ドラッグ距離が閾値を超えた場合）
- タッチでタップするとタイルが選択される
- タッチドラッグではタイルが選択されない

### ホバー表示

- マウスをタイルの上に移動するとホバーハイライトが表示される
- ホバー中に地形情報オーバーレイ（座標・地形名）が表示される
- 地形情報オーバーレイの座標が正しい（0始まり、列,行の順）
- 地形情報オーバーレイの地形名が正しい
- マウスがCanvasから離れるとホバーハイライトとオーバーレイが消える

### ミニマップ

- ミニマップがマップ全体を表す縮小図として表示される
- ミニマップ上のビューポート枠がメインマップの表示範囲と一致する
- ミニマップをクリックするとクリック位置を中心にメインマップがスクロールする
- ミニマップ上でクリックしたままマウスを動かすとメインマップが追従してスクロールする
- ミニマップのドラッグ中にマウスボタンを離すとドラッグが終了する
- ミニマップをタッチするとタップ位置を中心にメインマップがスクロールする
- ミニマップ上でタッチしたまま指を動かすとメインマップが追従してスクロールする
- ミニマップのタッチドラッグ中に指を離すとドラッグが終了する
- スクロール・ズーム操作でビューポート枠がリアルタイムに更新される

### 画像フォールバック

- 地形タイル画像が読み込めない場合、フォールバックカラーで表示される
- フォールバック表示でもホバー・選択が正常に動作する

### レスポンシブ

- ブラウザのウィンドウサイズを変更するとCanvasサイズが追従する
- リサイズ後もスクロール・ズーム・タイル選択が正常に動作する
- `ui_theme.json > layout.maxWidth` 以内に収まる

### ステータスバー

- P1のIG値が表示される
- P1のCT値が表示される
- P1のGP数・GB数・T数が表示される
- P1のユニット総数が `ui_theme.json > colors.player1.unitCount` の色の大きなフォントで表示される
- P2のIG値が表示される
- P2のCT値が表示される
- P2のGP数・GB数・T数が表示される
- P2のユニット総数が `ui_theme.json > colors.player2.unitCount` の色の大きなフォントで表示される
- ターン番号が `ui_theme.json > colors.turn.number` の色で表示される
- フェーズ表示が `ui_theme.json > colors.turn.phase` の色で表示される

### ステータスバー（テキストはみ出し防止）

- 幅375pxでP2のIG値テキスト全体がビューポート内に収まる
- 幅375pxでP2のCT値テキスト全体がビューポート内に収まる

### ステータスバー（レスポンシブ）

- 画面高さ500pxでもステータスバーの全要素がビューポート内に収まる
- 画面高さ500pxでもP1・P2のユニット総数が画面内に表示される
- 画面高さ500pxでもミニマップが画面内に表示される
- 画面高さ800px（PC）ではステータスバーの高さが150px以上ある
